% 随机生成建筑信息 保证建筑的类型固定，但是建筑的曲线的规模随机【二次验证的时候需要固定一下参数】
function [x, y, type,load_curve,pv_curve,flexible_load,storage_capacity] = GenerateBuildingInfo(n)
    % 随机生成建筑位置
    x = rand(1, n) * 7000; % 假设建筑在 7000×7000 ㎡ 的面积里面随机分布，【TODO：范围改大一点】
    y = rand(1, n) * 7000;
    
    % 随机生成建筑类型
    building_types = {'住宅建筑', '办公建筑', '工业园区', '文化建筑', '商业建筑'};
    type_indices = randi(length(building_types), 1, n);
    type = building_types(type_indices);

    % 确保建筑之间有一定的距离
    min_distance = 200; % 假设最小距离为 200米
    for i = 2:n
        while min(sqrt((x(i)-x(1:i-1)).^2 + (y(i)-y(1:i-1)).^2)) < min_distance
            x(i) = rand * 7000;
            y(i) = rand * 7000;
        end
    end
    % 日负荷曲线和日光伏曲线数据
residential_load_curve = [
    13.08496079 12.25281972 15.17949937 15.90979969 14.56351323 14.44564293 ...
    14.02760917 12.8025477 13.84792522 13.64159728 13.89642709 14.22147732 ...
    31.81797713 51.95645976 55.70776971 55.75550977 57.19272157 49.19171442 ...
    16.40371983 17.6090024 17.18703782 28.62132704 27.61387032 27.65720216 ...
    27.54515786 13.80567489 14.5032878 18.78952589 19.91008806 15.02583558 ...
    15.40247665 15.49271059 18.26198123 20.3968843 34.54849994 49.57967966 ...
    48.79875387 48.71183439 46.83070883 47.96503422 51.55579095 51.31370543 ...
    52.04563339 51.45039563 37.53729245 19.47399867 20.64957735 20.04211824
];
office_load_curve =  [
    15.04437593 17.76415236 16.30616242 16.31711275 15.09550231 18.27937034 ...
    21.44006305 19.89805162 18.94201263 15.67158073 17.41359553 18.84292404 ...
    19.12381503 16.81724585 16.92978444 29.45133221 43.82343023 79.64273614 ...
    101.869079 95.46401401 96.80910545 97.53442126 96.53309931 93.1734294 ...
    94.6747337 86.83642283 87.99929421 84.02903918 89.11674352 94.42171355 ...
    83.60026781 87.38132568 88.73729792 93.86209002 93.59105251 80.33972959 ...
    26.84639703 29.36064603 28.62730344 24.60419323 14.85881697 13.51251433 ...
    14.68703006 15.8568635 13.24331524 14.81768833 13.56081221 14.04709281
]; % Office building load curve data
industrial_load_curve =[
    115.5393373 116.0294803 116.5298157 117.0838934 113.7957128 ...
    116.3873654 114.4189639 118.2836988 116.46025 115.2953023 ...
    116.7452051 113.4595541 115.6831261 117.5975493 119.8613809 ...
    115.0879841 120.6919712 118.3829065 117.2111104 113.4214266 ...
    117.391781 111.0274653 113.2687351 113.0481783 120.0947973 ...
    117.3792185 111.9676118 113.1237416 117.8463158 119.3702893 ...
    118.5443597 121.9820985 120.3169952 123.3481844 117.8965052 ...
    117.8132046 116.1319745 116.604908 116.3309364 117.8896228 ...
    114.6025492 116.5962844 119.8799726 120.1433802 119.7761275 ...
    116.5988517 116.8381943 115.8537333
]; % Industrial building load curve data
cultural_load_curve =  [
    12.31153281 12.1021693 11.95544802 12.03274212 11.68327331 ...
    11.821641 11.89441732 12.01608623 11.44239982 11.30754208 ...
    12.22483089 12.2323818 12.73899194 12.45104077 33.55117828 ...
    41.100305 41.20862966 42.20751755 42.70232854 41.40927583 ...
    44.66449776 42.49886584 43.92052085 41.01239398 41.66043615 ...
    39.23531848 38.93589422 37.73168918 37.75955392 37.79525124 ...
    36.66426881 38.11126563 36.1611528 35.04027803 36.92663276 ...
    35.34320501 37.88535362 37.2018506 38.27246905 38.74188302 ...
    37.85061374 15.33688886 13.92244522 12.96689163 12.45160168 ...
    12.29626743 12.09749449 12.2342024
];
 % Cultural building load curve data
commercial_load_curve =[
    33.4941107 40.80656816 31.62560201 30.34965608 35.03326872 ...
    37.40739196 38.7300695 38.08739724 42.00628598 36.06025056 ...
    29.49604742 33.67457656 34.63467872 32.49396214 36.65679687 ...
    33.2565489 35.03526223 43.20803564 45.74649736 88.23365952 ...
    106.9225355 114.8750741 108.7977911 114.3732763 109.9901016 ...
    118.21732 119.991222 118.3776647 111.5902767 111.1081882 ...
    123.2658119 118.9395147 119.2994868 107.8532554 112.8142494 ...
    118.677254 114.033292 114.9346309 120.4704579 117.3552001 ...
    118.8985892 117.8044699 116.6433369 52.08389903 41.02184147 ...
    40.49673462 29.21324679 36.19046173
];% Commercial building load curve data

residential_pv_curve =  [0,0,0,0,0,0,0,0,0,0,0,0,5.4,9.405,14.31,20.16,26.91,33.435,40.455,44.865,48.96,52.695,57.375,56.655,57.465,55.26,56.88,56.25,53.64,50.445,47.745,45,38.88,33.21,22.77,13.455,10.53,6.39,3.87,0.765,0,0,0,0,0,0,0,0]; % Residential building PV output curve data
office_pv_curve = [0,0,0,0,0,0,0,0,0,0,0,0,10.692,18.6219,28.3338,39.9168,53.2818,66.2013,80.1009,88.8327,96.9408,104.3361,113.6025,112.1769,113.7807,109.4148,112.6224,111.375,106.2072,99.8811,94.5351,89.1,76.9824,65.7558,45.0846,26.6409,20.8494,12.6522,7.6626,1.5147,0,0,0,0,0,0,0,0]; % Office building PV output curve data
industrial_pv_curve = [0,0,0,0,0,0,0,0,0,0,0,0,15.55651101,27.09425668,41.22475418,58.07764112,77.52327988,96.32073069,116.544195,129.248679,141.0456999,151.80562,165.2879295,163.213728,165.5472047,159.1949627,163.861916,162.0469897,154.5280094,145.3237404,137.5454849,129.6375918,112.0068793,95.67254273,65.59662144,38.76163994,30.33519648,18.40853803,11.14883289,2.20383906,0,0,0,0,0,0,0,0];% Industrial building PV output curve data
cultural_pv_curve = [0,0,0,0,0,0,0,0,0,0,0,0,5.77074851,10.05072032,15.29248355,21.54412777,28.75756341,35.73055119,43.23252426,47.94530221,52.32145316,56.31288755,61.31420292,60.54476979,61.41038206,59.05399309,60.78521764,60.11196365,57.32276853,53.908409,51.02303474,48.08957092,41.54938927,35.49010334,24.33332288,14.3787817,11.25295959,6.82871907,4.135703099,0.817522706,0,0,0,0,0,0,0,0]; % Cultural building PV output curve data
commercial_pv_curve =[0,0,0,0,0,0,0,0,0,0,0,0,14.22036,24.767127,37.683954,53.089344,70.864794,88.047729,106.534197,118.147491,128.931264,138.767013,151.091325,149.195277,151.328331,145.521684,149.787792,148.12875,141.255576,132.841863,125.731683,118.503,102.386592,87.455214,59.962518,35.432397,27.729702,16.827426,10.191258,2.014551,0,0,0,0,0,0,0,0];
 % Commercial building PV output curve data

 % 初始化负载和光伏曲线
    load_curve = cell(1, n);
    pv_curve = cell(1, n);
    flexible_load =zeros(1,n);
    storage_capacity=zeros(1,n);
% 根据建筑类型分配对应的曲线数据
  rng(1); % 设置随机种子以便结果可重复
  for j = 1:n
        switch type{j}
            case '住宅建筑'
                load_curve{j} =(0.5+rand())*residential_load_curve;
                pv_curve{j} = (0.5+rand())*residential_pv_curve;
                flexible_load{j}=(0.5+rand())*sum(residential_load_curve)*1/3;
                storage_capacity{j}=(0.5+rand())*0.2*sum(residential_load_curve);
            case '办公建筑'
                load_curve{j} = (0.5+rand())*office_load_curve;
                pv_curve{j} = (0.5+rand())*office_pv_curve;
                flexible_load{j}=(0.5+rand())*sum(office_load_curve)*1/3;
                storage_capacity{j}=(0.5+rand())*0.2*sum(residential_load_curve);
            case '工业园区'
                load_curve{j} = (0.5+rand())*industrial_load_curve;
                pv_curve{j} = (0.5+rand())*industrial_pv_curve;
                flexible_load{j}=(0.5+rand())*sum(industrial_load_curve)*1/3;
                storage_capacity{j}=(0.5+rand())*0.2*sum(residential_load_curve);
            case '文化建筑'
                load_curve{j} =(0.5+rand())* cultural_load_curve;
                pv_curve{j} = (0.5+rand())*cultural_pv_curve;
                flexible_load{j}=(0.5+rand())*sum(cultural_load_curve)*1/3;
                storage_capacity{j}=(0.5+rand())*0.2*sum(residential_load_curve);
            case '商业建筑'
                load_curve{j} =(0.5+rand())* commercial_load_curve;
                pv_curve{j} =(0.5+rand())* commercial_pv_curve;
                flexible_load{j}=(0.5+rand())*sum(commercial_load_curve)*1/3;
                storage_capacity{j}=(0.5+rand())*0.2*sum(residential_load_curve);
            otherwise
                error('Invalid building type');
        end
   end
end
